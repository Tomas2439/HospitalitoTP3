<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <script>
        // Aplicar tema antes del renderizado (evita flash blanco)
        (function() {
            try {
                const savedTheme = localStorage.getItem('theme');
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

                if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            } catch (e) {
                console.error('Error aplicando tema:', e);
            }
        })();
    </script>
    <meta charset="utf-8"/>
    <!-- Preconexión a Google Fonts para optimizar la carga -->
    <link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
    <link as="style" href="https://fonts.googleapis.com/css2?display=swap&family=Inter:wght@400;500;700;900" onload="this.rel='stylesheet'" rel="stylesheet"/>

    <title>Lito Hospital Dashboard</title>
    <!-- Favicon base64 vacío (placeholder) -->
    <link href="data:image/x-icon;base64," rel="icon" type="image/x-icon"/>

    <!-- TailwindCSS con plugins Forms y Container Queries -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        // Configuración de Tailwind extendida
        tailwind.config = {
          darkMode: 'class', // activación de modo oscuro por clase
          theme: {
            extend: {
              colors: {
                primary: '#11a4d4',
                'background-light': '#f6f8f8',
                'background-dark': '#101d22',
              },
              fontFamily: {
                display: ['Inter'], // Fuente principal
              },
              borderRadius: { DEFAULT: '0.25rem', lg: '0.5rem', xl: '0.75rem', full: '9999px' },
            },
          },
        };
    </script>

    <!-- Iconos de Material Symbols -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
</head>

<body class="bg-background-light dark:bg-background-dark font-display">
<div class="flex h-screen">

    <!-- ===========================
         Sidebar de navegación
         =========================== -->
    <aside class="flex w-64 flex-col bg-background-light dark:bg-background-dark border-r border-primary/20 dark:border-primary/30">
        <!-- Logo y nombre -->
        <div class="flex h-20 items-center gap-3 px-6">
            <div class="text-primary w-8 h-8">
                <svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                    <path d="M24 45.8096C19.6865 45.8096 15.4698 44.5305 11.8832 42.134C8.29667 39.7376 5.50128 36.3314 3.85056 32.3462C2.19985 28.361 1.76794 23.9758 2.60947 19.7452C3.451 15.5145 5.52816 11.6284 8.57829 8.5783C11.6284 5.52817 15.5145 3.45101 19.7452 2.60948C23.9758 1.76795 28.361 2.19986 32.3462 3.85057C36.3314 5.50129 39.7376 8.29668 42.134 11.8833C44.5305 15.4698 45.8096 19.6865 45.8096 24L24 24L24 45.8096Z" fill="currentColor"></path>
                </svg>
            </div>
            <h1 class="text-xl font-bold text-black dark:text-white">Hospital Lito</h1>
        </div>
        <div class="px-4 pb-4">
            <button id="darkModeToggle"
                    class="flex w-full items-center justify-between gap-3 rounded-lg px-4 py-2.5 text-black dark:text-white hover:bg-primary/20 dark:hover:bg-primary/30 transition-colors">
                <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined">dark_mode</span>
                    <span class="text-sm font-medium">Modo oscuro</span>
                </div>
                <!-- Toggle switch -->
                <div class="relative inline-flex h-6 w-11 items-center rounded-full bg-gray-300 dark:bg-primary transition-colors">
                    <span class="inline-block h-4 w-4 transform rounded-full bg-white transition-transform translate-x-1 dark:translate-x-6"></span>
                </div>
            </button>
        </div>
        <!-- Menú de navegación con estado activo -->
        <nav class="flex-1 space-y-2 px-4">
            <a class="flex items-center gap-3 rounded-lg bg-primary/20 dark:bg-primary/30 px-4 py-2.5 text-black dark:text-white" th:href="@{/hospitalito}">
                <span class="material-symbols-outlined">dashboard</span>
                <span class="text-sm font-medium">Dashboard</span>
            </a>
            <a class="flex items-center gap-3 rounded-lg px-4 py-2.5 text-black dark:text-white hover:bg-primary/20 dark:hover:bg-primary/30" th:href="@{/hospitalito/asignaciones}">
                <span class="material-symbols-outlined">assignment_ind</span>
                <span class="text-sm font-medium">Asignaciones</span>
            </a>
            <a class="flex items-center gap-3 rounded-lg px-4 py-2.5 text-black dark:text-white hover:bg-primary/20 dark:hover:bg-primary/30" th:href="@{/hospitalito/enfermeras}">
                <span class="material-symbols-outlined">badge</span>
                <span class="text-sm font-medium">Enfermeras</span>
            </a>
            <a class="flex items-center gap-3 rounded-lg px-4 py-2.5 text-black dark:text-white hover:bg-primary/20 dark:hover:bg-primary/30" th:href="@{/hospitalito/camas}">
                <span class="material-symbols-outlined">bed</span>
                <span class="text-sm font-medium">Camas</span>
            </a>
            <a class="flex items-center gap-3 rounded-lg px-4 py-2.5 text-black dark:text-white hover:bg-primary/20 dark:hover:bg-primary/30" th:href="@{/hospitalito/pacientes}">
                <span class="material-symbols-outlined">personal_injury</span>
                <span class="text-sm font-medium">Pacientes</span>
            </a>
        </nav>

        <!-- Información de usuario y logout -->
        <div class="p-4">
            <div class="flex items-center gap-3">
                <div>
                    <p class="text-sm font-semibold text-black dark:text-white" th:text="${usuarioLogueado}"></p>
                    <p class="text-xs text-black/60 dark:text-white/60">Administrator</p>
                </div>
                <form th:action="@{/logout}" method="post" id="logoutForm" style="display:none;"></form>
                <a href="#" class="ml-auto text-black dark:text-white" onclick="document.getElementById('logoutForm').submit();">
                    <span class="material-symbols-outlined">logout</span>
                </a>
            </div>
        </div>
    </aside>

    <!-- ===========================
         Main content
         =========================== -->
    <main class="flex-1 overflow-y-auto">
        <!-- Header del dashboard con sticky y blur -->
        <header class="sticky top-0 z-10 flex h-20 items-center justify-between border-b border-primary/20 dark:border-primary/30 bg-background-light/80 dark:bg-background-dark/80 px-8 backdrop-blur-sm">
            <div>
                <h2 class="text-2xl font-bold text-black dark:text-white">Dashboard</h2>
                <p class="text-sm text-black/60 dark:text-white/60">vista de las camas ocupadas y enfermeras disponibles</p>
            </div>
        </header>

        <!-- ===========================
             Tarjetas de resumen
             =========================== -->
        <div class="p-8">
            <div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5">
                <!-- Cada tarjeta muestra métricas importantes -->
                <div class="flex flex-col gap-2 rounded-xl bg-primary/10 dark:bg-primary/20 p-6">
                    <p class="text-base font-medium text-black dark:text-white">Total de camas</p>
                    <p class="text-4xl font-bold text-black dark:text-white" th:text="${cantidadDeCamas}"></p>
                </div>
                <div class="flex flex-col gap-2 rounded-xl bg-primary/10 dark:bg-primary/20 p-6">
                    <p class="text-base font-medium text-black dark:text-white">Camas ocupadas</p>
                    <p class="text-4xl font-bold text-black dark:text-white" th:text="${camasOcupadas}"></p>
                </div>
                <div class="flex flex-col gap-2 rounded-xl bg-primary/10 dark:bg-primary/20 p-6">
                    <p class="text-base font-medium text-black dark:text-white">Camas disponibles</p>
                    <p class="text-4xl font-bold text-black dark:text-white" th:text="${camasDisponibles}"></p>
                </div>
                <div class="flex flex-col gap-2 rounded-xl bg-primary/10 dark:bg-primary/20 p-6">
                    <p class="text-base font-medium text-black dark:text-white" >Enfermeras activas</p>
                    <p class="text-4xl font-bold text-black dark:text-white" th:text="${enfermerasActivas}"></p>
                </div>
                <div class="flex flex-col gap-2 rounded-xl bg-primary/10 dark:bg-primary/20 p-6">
                    <p class="text-base font-medium text-black dark:text-white">Enfermeras inactivas</p>
                    <p class="text-4xl font-bold text-black dark:text-white" th:text="${enfermerasInactivas}"></p>
                </div>
            </div>

            <!-- ===========================
                 Tabla resumen por categoría de camas
                 =========================== -->
            <div class="mt-8">
                <h3 class="mb-4 text-xl font-bold text-black dark:text-white">Categorías de camas</h3>
                <div class="overflow-x-auto rounded-lg border border-primary/20 dark:border-primary/30 bg-background-light dark:bg-background-dark">
                    <table class="min-w-full text-left">
                        <thead class="border-b border-primary/20 dark:border-primary/30">
                        <tr>
                            <th class="px-6 py-4 text-sm font-semibold text-black dark:text-white">Categoría</th>
                            <th class="px-6 py-4 text-sm font-semibold text-black dark:text-white">Total</th>
                            <th class="px-6 py-4 text-sm font-semibold text-black dark:text-white">Ocupadas</th>
                            <th class="px-6 py-4 text-sm font-semibold text-black dark:text-white">Disponibles</th>
                        </tr>
                        </thead>
                        <tbody class="divide-y divide-primary/20 dark:divide-primary/30">
                        <tr th:each="c : ${resumenCamas}">
                            <td class="px-6 py-4 text-sm font-medium text-black dark:text-white" th:text="${c.nombre}"></td>
                            <td class="px-6 py-4 text-sm text-black/80 dark:text-white/80" th:text="${c.total}"></td>
                            <td class="px-6 py-4 text-sm text-black/80 dark:text-white/80" th:text="${c.ocupadas}"></td>
                            <td class="px-6 py-4 text-sm text-black/80 dark:text-white/80" th:text="${c.disponibles}"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </main>
</div>
<script th:src="@{/scripts/dashboard.js}"></script>
</body>
</html>

